{% extends "base.html" %}
{% load staticfiles %}
{% load helper %}

{% block body %}
{{block.super}}
<div class="content">
	{% if content.msg %}
		<span>{{content.msg}}</span>
	{% endif %}

	<div class="headline">
		<h1 class="game_headline">{{ content.game }}</h1>
	</div>

	{% for match in content.match %}
	<div class="match_info">
		{% if match.game_mode %}
		<div class="game_mode">
			<h5 class="row_info">Spielmodus</h5>
			<h2 class="game_info">{{ match.game_mode }}</h2>
		</div>
		{% endif %}
		{% if match.description %}
		<div class="description">
			<h5 class="row_info">Beschreibung</h5>
			<h2 class="game_info">{{ match.description }}</h2>
		</div>
		{% endif %}
		<div class="player">
			<h5 class="row_info">Spieler pro Team</h5>
			<h2 class="game_info">{{ match.player_per_team }}</h2>
		</div>
		<div class="user">
			<h5 class="row_info">Angemeldete Benutzer</h5>
			<ul>
			{% for user in match.user.all %}
	 		<li class="player_name match_id_{{match.id}}" id="user_id_{{user.id}}">{{ user }}</li>
			{% endfor %}
			</ul>
			<form method="post" action="">
				{% csrf_token %}
				<input type="submit" class="match_register" data-match-id="{{match.id}}" data-user-id="{{user.id}}" type="submit" value="Anmelden" />
				<input type="hidden" name="match_id" value="{{match.id}}" />
			</form>
		</div>
	</div>

	<div class="teams">
		{% if match.team_match.all %}
			{% for team in match.team_match.all %}
				{% ifequal forloop.counter0|modulo:3 0 %}
				<div class="team_row">
				{% endifequal %}
				<div class="team" id="team_id_{{team.id}}">
					<h3>Team {{team.description}}</h3>
					<ul>
						{% for user in team.user.all %}
						<li>{{ user }}</li>
						{% endfor %}
					</ul>
				</div>
				{% if forloop.counter0|modulo:3 == 2 or forloop.last %}
				</div>
				{% endif %}
			{% endfor %}
		{% elif request.user|has_group:"admin" %}
				<form method="post" action="/calc_teams">
				{% csrf_token %}
				<input type="submit" class="create_teams" type="submit" value="Teams erstellen" />
				<input type="hidden" name="match_id" value="{{match.id}}" />
			</form>
		{% endif %}
	</div>
	{% endfor %}
</div>
{% endblock %}